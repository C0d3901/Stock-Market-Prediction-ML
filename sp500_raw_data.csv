import pandas as pd

# Load raw CSV
data = pd.read_csv("data/sp500_raw.csv", parse_dates=['Date'], index_col='Date')

# Feature engineering
data['Target'] = (data['Close'].shift(-1) > data['Close']).astype(int)
for w in [5, 10, 20]:
    data[f'Close_{w}'] = data['Close'].rolling(w).mean()

data.dropna(inplace=True)

# Save processed CSV
data.to_csv("data/sp500_features.csv")

import pandas as pd

# Load raw CSV
data = pd.read_csv("data/sp500_raw.csv", parse_dates=['Date'], index_col='Date')

# Feature engineering
data['Target'] = (data['Close'].shift(-1) > data['Close']).astype(int)
for w in [5, 10, 20]:
    data[f'Close_{w}'] = data['Close'].rolling(w).mean()

data.dropna(inplace=True)

# Save processed CSV
data.to_csv("data/sp500_features.csv")
